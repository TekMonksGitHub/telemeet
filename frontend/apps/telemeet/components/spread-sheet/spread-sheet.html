<!--
/* 
 * (C) 2020 TekMonks. All rights reserved.
 * License: See enclosed license.txt file.
 */
 -->
<style>

body::-webkit-scrollbar {
    width: 0.5em !important;
    height: 0.5em !important;
    scroll-behavior: smooth !important;
}

body::-webkit-scrollbar-track {
    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3) !important;
    box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3) !important;
    margin: 40px;
    border-radius: 10px !important;
}

body::-webkit-scrollbar-thumb {
    background-color: darkgrey !important;
    border-radius: 10px !important;
    background-clip: padding-box;
}

body {
    margin: 0%;
    height: 100%;
    overflow: auto;
}

div#tableBorderDiv {
    border-radius: 5px 5px 0px 0px;
    background-color: #00C24E;
}

table {
    table-layout: fixed;
    width: 100%;
    border-spacing: 0px;
    border-radius: 5px;
    border: 0.5px solid #444444;
    height: 100%;
    border-collapse: collapse;
}

tr {min-height: 1.2em;}

td {
    border: 0.5px solid #444444;
    border-radius: 0px;
    background-color: white;
    padding: 0px;
    overflow: hidden;
}

td > textarea {
    background-color: transparent;
    border: 0px;
    outline: none;
    color: inherit;
    resize: none;
    padding: 4px;
    width: 100%;
    overflow: hidden;
    font-family: inherit;
    display: block;
    box-sizing: border-box;
}

tr:first-child > td {
    background-color: #444444; 
    color: white; 
    border-right-color: white;
}

tr:first-child > td:last-child {border-color: #444444; border-top-right-radius: 4px;}
tr:last-child > td:last-child {border-color: #444444; border-bottom-right-radius: 4px;}
tr:last-child > td:first-child {border-color: #444444; border-bottom-left-radius: 4px;}

td:focus-within {background-color: yellow; color: #444444;}
td > textarea:focus {background-color: yellow; color: #444444;}

span#toolbar {
    padding-bottom: 10px; 
    display: inline-flex;
    align-items: center;
    width: 100%;
    flex-direction: row;
    justify-content: space-between;
    max-width: calc(100vw - 192px);
}

span#toolbar > span > span {
    align-items: center;
    display: inline-flex;
    font-size: smaller;
    font-family: 'Red Hat Text';
    padding-right: 4vw;
}

span#toolbar > span > span:last-child {padding-right: 0vw;}

span#toolbar > span > span.button {
    padding: 5px 10px 5px 10px;
    border: 1px solid #C6E3FF;
    border-radius: 5px;
    background-color: #D6EFFF;
    cursor: default;
    margin-right: 4vw;
}

span#toolbar span#middleitems {margin-left: 5vw; margin-right: 5vw;}

span#toolbar > span > span.button:last-child {margin-right: 0vw;}

span#tabbar {display: flex; user-select: none;}

span#tabbar > span.tabbutton {
    border-radius: 0px 0px 10px 10px;
    background-color: #E5E5E5;
    margin-right: 10px;
    padding: 0px 5px 5px 5px;
    min-width: 5vw;
    border: 1px solid #828283;
    border-top: transparent;
    height: fit-content;
}
span#tabbar > span.tabbutton.active {background-color: #ffffff}
span#tabbar > span > input {
    width: 100%;
    outline: none;
    font-size: x-small; 
    user-select: none;
    border: 0px;
    background: transparent;
    cursor: default;
}

img.button {width: 20px;}

</style>
{{#showSearch}}
<style>
table {border-radius: 5px 5px 0px 0px; height: calc(100% - 3em);}
tr:last-child > td:last-child {border-color: #444444; border-bottom-right-radius: 0px;}
tr:last-child > td:first-child {border-color: #444444; border-bottom-left-radius: 0px;}
span#search {display: inline-flex; flex-direction: row; width: 100%;}
img#search {
    position: relative; 
    left: 0px; 
    height: 2em; 
    top: 0px;
    border: 0.5px solid #444444;
    border-top: none;
    border-right: none;
    border-radius: 0px 0px 0px 0.3em;
    background-color: #E5E5E5;
    padding: 2px;
}
input#search {
    width: 100%;
    outline: none;
    border: 0.5px solid #444444;
    border-top: none;
    border-left: none;
    min-height: 2em;
    border-radius: 0px 0px 0.3em 0px;
    padding: 5px;
    background-color: #E5E5E5;
}
</style>
{{/showSearch}}


{{{styleBody}}}

{{#showToolbar}}
<span id="toolbar">
    <span id="leftitems">
        <span><img src="{{{componentPath}}}/img/delete.svg" onclick='monkshu_env.components["spread-sheet"].rowop("delete",this)'>&nbsp;&nbsp;{{i18n.Rows}}&nbsp;&nbsp;<img src="{{{componentPath}}}/img/add.svg" onclick='monkshu_env.components["spread-sheet"].rowop("add",this)'></span>
        <span><img src="{{{componentPath}}}/img/delete.svg" onclick='monkshu_env.components["spread-sheet"].columnop("delete",this)'>&nbsp;&nbsp;{{i18n.Columns}}&nbsp;&nbsp;<img src="{{{componentPath}}}/img/add.svg" onclick='monkshu_env.components["spread-sheet"].columnop("add",this)'></span>
    </span>
    <span id="middleitems">
        {{{toolbarPluginHTML}}}
    </span>
    <span id="rightitems">
        <span class="button" onclick='monkshu_env.components["spread-sheet"].open(this)'><img class="button" src="{{{componentPath}}}/img/open.svg">&nbsp;&nbsp;{{i18n.Load}}</span>
        <span class="button" onclick='monkshu_env.components["spread-sheet"].save(this)'><img class="button" src="{{{componentPath}}}/img/save.svg">&nbsp;&nbsp;{{i18n.Save}}</span>
    </span>
</span>
{{/showToolbar}}

<div id="tableBorderDiv">
<table id="spreadsheet">
    {{#rows}}
    <tr>
        {{#columns}}<td onclick='this.querySelector("textarea").focus()'><textarea rows="1" 
            onpaste='monkshu_env.components["spread-sheet"].cellpastedon(this, event)'
            oninput='monkshu_env.components["spread-sheet"].resizeRowInputsForLargestScroll(this)'
            onchange="this.oninput()" onfocus="this.oninput()" spellcheck="false"
            onkeypress="if (event.keyCode == 13) event.preventDefault();" {{#readOnlySheet}}readonly{{/readOnlySheet}}></textarea>
        </td>{{/columns}}
    </tr>
    {{/rows}}
</table>
</div>

{{#showSearch}}
<span id="search">
    <img id="search" src="{{{componentPath}}}/img/search.svg">
    <input type="text" placeholder="Search" id="search" data-value="{{searchText}}"
        oninput='monkshu_env.components["spread-sheet"].searchModified(this)'>
</span>
{{/showSearch}}

{{#tabs}}<span id="tabbar">{{/tabs}}
    {{#tabs}}
    <span id="{{id}}" class="tabbutton{{#active}} active{{/active}}" 
        onclick='monkshu_env.components["spread-sheet"].switchSheet(this, "{{id}}")'
        oncontextmenu='event.stopPropagation(); monkshu_env.components["spread-sheet"].tabMenuClicked(event, this, "{{id}}"); return false;'>
            <input id="tabLabel" type="text" value="{{name}}" size="5" readonly>
    </span>
    {{/tabs}}
{{#tabs}}</span>{{/tabs}}

<context-menu id="{{{CONTEXT_MENU_ID}}}"></context-menu>